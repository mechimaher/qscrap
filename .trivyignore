# Trivy Ignore File
# Suppress false positives and accepted risks

# ============================================
# Stripe Test Key Placeholders (FALSE POSITIVE)
# ============================================
# These are NOT actual secrets - they're placeholder strings in compiled TypeScript
# The actual secret is loaded from environment variables at runtime
# Pattern: process.env.STRIPE_SECRET_KEY || '*******************'

# Ignore Stripe secret detections in compiled dist/ files
/app/dist/services/subscription/billing.job.js:stripe-secret-token
/app/dist/services/subscription/payment-methods.service.js:stripe-secret-token
/app/dist/services/subscription/subscription.service.js:stripe-secret-token

# ============================================
# Node.js Dependencies (ACCEPTED RISK)
# ============================================
# These are dev dependencies used only in build/test, not in production runtime
# Upgrading would require major version changes and testing

# cross-spawn - ReDoS vulnerability (dev dependency only)
CVE-2024-21538

# glob - Command injection via malicious filenames (dev dependency only)
CVE-2025-64756

# tar - File overwrite vulnerabilities (dev dependency only)
CVE-2026-23745
CVE-2026-23950
CVE-2026-24842

# ============================================
# Alpine Base Image (ACCEPTED RISK)
# ============================================
# Alpine Linux packages are minimal and hardened
# Most CVEs are low-impact or require local access
# Container runs as non-root user with minimal privileges

# BusyBox / Alpine utils (mitigated by container isolation)
CVE-2016-2781

# OpenSSL - Low severity / feature requests
CVE-2023-5363
CVE-2023-5678

# Alpine 3.19/3.20 common CVEs (accepted risk for minimal attack surface)
CVE-2023-42363
CVE-2023-42364
CVE-2023-42365
CVE-2023-42366
CVE-2024-0553
CVE-2024-0567
CVE-2024-2398
CVE-2024-2961
CVE-2024-32465
CVE-2024-34438
CVE-2024-37370
CVE-2024-37371
CVE-2024-6193
CVE-2024-6345
